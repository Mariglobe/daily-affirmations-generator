<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Affirmation Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #a7e6ff 0%, #d1f7ff 100%); /* Soft blue gradient */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
            color: #333;
        }

        .container {
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            max-width: 90%;
            width: 500px;
            text-align: center;
            box-sizing: border-box;
            border: 1px solid #e0e0e0;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2c3e50; /* Darker blue-gray */
            margin-bottom: 0.5rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }

        p {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #555;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        label {
            font-size: 1rem;
            font-weight: 600;
            color: #444;
            text-align: left;
            margin-left: 0.25rem;
        }

        input[type="text"], select {
            padding: 0.8rem 1rem;
            border: 2px solid #a7e6ff; /* Light blue border */
            border-radius: 0.75rem;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.08);
            width: 100%; /* Ensure select takes full width */
            -webkit-appearance: none; /* Remove default dropdown arrow for custom styling */
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%236B7280'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem; /* Make space for the custom arrow */
        }

        input[type="text"]:focus, select:focus {
            border-color: #007bff; /* Brighter blue on focus */
            box-shadow: 0 0 0 4px rgba(0, 123, 255, 0.2);
        }

        button {
            background: linear-gradient(180deg, #007bff 0%, #0056b3 100%); /* Blue gradient button */
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: bold;
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 8px 15px rgba(0, 123, 255, 0.3);
            margin-top: 1rem;
        }

        button:hover {
            background: linear-gradient(180deg, #0056b3 0%, #004085 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(0, 123, 255, 0.4);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.2);
        }

        .affirmation-display {
            background-color: #f0f8ff; /* Lighter blue background for display */
            border: 2px dashed #a7e6ff;
            border-radius: 1rem;
            padding: 1.5rem;
            min-height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.3rem;
            font-weight: 600;
            color: #0056b3; /* Darker blue text */
            margin-top: 1.5rem;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            transition: all 0.5s ease-in-out;
            opacity: 0; /* Start hidden for animation */
            transform: translateY(20px);
        }

        .affirmation-display.show {
            opacity: 1;
            transform: translateY(0);
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem; /* Spacing between buttons */
            margin-top: 1.5rem;
        }

        .action-button {
            background-color: #6c757d; /* Gray button */
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-button:hover {
            background-color: #5a6268; /* Darker gray on hover */
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .action-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .action-button.whatsapp { background-color: #25D366; }
        .action-button.whatsapp:hover { background-color: #1DA851; }
        .action-button.twitter { background-color: #1DA1F2; }
        .action-button.twitter:hover { background-color: #0F82D3; }
        .action-button.listen { background-color: #FF5722; } /* Orange for listen */
        .action-button.listen:hover { background-color: #E64A19; }


        /* Styles for the support link */
        .support-section {
            margin-top: 2.5rem; /* More space above the support section */
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px dashed #e0e0e0; /* A subtle separator */
        }

        .support-text {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 1rem;
        }

        .support-button {
            display: inline-block;
            background: linear-gradient(180deg, #28a745 0%, #218838 100%); /* Green gradient button */
            color: white;
            font-weight: bold;
            padding: 0.9rem 1.8rem;
            border-radius: 0.75rem;
            box-shadow: 0 6px 12px rgba(40, 167, 69, 0.3);
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            text-decoration: none; /* Remove underline from link */
            font-size: 1.1rem;
        }

        .support-button:hover {
            background: linear-gradient(180deg, #218838 0%, #1e7e34 100%);
            transform: translateY(-2px);
            box-shadow: 0 9px 18px rgba(40, 167, 69, 0.4);
        }

        .support-button:active {
            transform: translateY(0);
            box-shadow: 0 3px 8px rgba(40, 167, 69, 0.2);
        }

        .small-support-text {
            color: #777;
            font-size: 0.85rem;
            margin-top: 0.75rem;
        }

        .daily-reminder {
            margin-top: 2rem;
            font-size: 1rem;
            color: #555;
            font-style: italic;
        }

        /* New styles for book advertisements */
        .book-ads-section {
            margin-top: 2.5rem;
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px dashed #e0e0e0;
        }

        .book-ads-section h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .book-link-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            align-items: center;
        }

        .book-link {
            display: inline-block;
            background-color: #f3f4f6; /* Light gray background for book links */
            color: #4a5568; /* Darker text */
            padding: 0.75rem 1.25rem;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            width: fit-content; /* Adjust width to content */
        }

        .book-link:hover {
            background-color: #e2e8f0;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }


        /* Responsive adjustments */
        @media (max-width: 640px) {
            h1 {
                font-size: 2rem;
            }
            .container {
                padding: 1.5rem;
                gap: 1rem;
            }
            button, .support-button {
                padding: 0.8rem 1.5rem;
                font-size: 1.1rem;
            }
            .affirmation-display {
                font-size: 1.1rem;
                padding: 1rem;
            }
            .support-text {
                font-size: 1rem;
            }
            .action-button {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
                gap: 0.3rem;
            }
            .book-ads-section h3 {
                font-size: 1.2rem;
            }
            .book-link {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>✨ Your Daily Affirmation ✨</h1>
        <p>Enter your name and select a category to receive a positive message just for you!</p>

        <div class="input-group">
            <label for="userName">Your Name (Optional):</label>
            <input type="text" id="userName" placeholder="e.g., Alex" aria-label="Your Name">
        </div>

        <div class="input-group">
            <label for="categorySelect">Choose a Category:</label>
            <select id="categorySelect" aria-label="Affirmation Category">
                <!-- Options will be populated by JavaScript -->
            </select>
        </div>

        <div class="input-group">
            <label for="voiceSelect">Choose a Voice:</label>
            <select id="voiceSelect" aria-label="Voice Selection">
                <!-- Voice options will be populated by JavaScript -->
            </select>
        </div>

        <button id="generateBtn">Get Affirmation</button>

        <div id="affirmationOutput" class="affirmation-display">
            Your affirmation will appear here!
        </div>

        <div class="action-buttons">
            <button id="copyBtn" class="action-button">📋 Copy</button>
            <button id="listenBtn" class="action-button listen">🔊 Listen</button>
            <button id="shareWhatsappBtn" class="action-button whatsapp">💬 WhatsApp</button>
            <button id="shareTwitterBtn" class="action-button twitter">🐦 X</button>
        </div>

        <!-- Support Section - Show Your Love -->
        <div class="support-section">
            <p class="support-text">Enjoying your daily dose of positivity?</p>
            <a href="https://selar.com/showlove/mariglobe" target="_blank" class="support-button">
                💖 Show Your Love!
            </a>
            <p class="small-support-text">Your support helps keep this app running!</p>
        </div>
        <!-- End Support Section -->

        <!-- Book Advertisements Section -->
        <div class="book-ads-section">
            <h3>📚 Explore More Resources!</h3>
            <div class="book-link-container">
                <a href="https://forms.gle/N8nuoTBdtsCk3HTp8" target="_blank" class="book-link">
                    💰 "How People Are Making Money Online Today" (Free Ebook!)
                </a>
                <a href="https://selar.com/stressnomore" target="_blank" class="book-link">
                    😌 "Stress No More" Ebook
                </a>
            </div>
            <p class="small-support-text mt-4">Discover more tools for growth and well-being.</p>
        </div>
        <!-- End Book Advertisements Section -->

        <p class="daily-reminder">Come back daily for another dose of peace and inspiration 🌸</p>

    </div>

    <script>
        // Categorized affirmations - EXPANDED SIGNIFICANTLY
        const affirmationsByCategory = {
            "All Categories": [
                "You are capable of amazing things.",
                "Your potential is limitless.",
                "You are worthy of all good things.",
                "Every day is a new opportunity to shine.",
                "You are strong, resilient, and brave.",
                "Your unique qualities make you special.",
                "You attract abundance and joy into your life.",
                "You are growing and evolving every day.",
                "You are surrounded by love and support.",
                "Believe in yourself and all that you are.",
                "You are a magnet for success and happiness.",
                "Your positive attitude creates positive outcomes.",
                "You are a beacon of light and positivity.",
                "Your creativity flows effortlessly.",
                "You are perfectly imperfect and that's beautiful.",
                "Challenges are opportunities for growth.",
                "You are in control of your reactions.",
                "Today is a gift, and you are its receiver.",
                "Your voice matters, and your ideas are valuable.",
                "You are building the life of your dreams.",
                "Peace and harmony reside within you.",
                "You are open to new possibilities.",
                "Your energy is contagious and inspiring.",
                "You are loved, cherished, and appreciated.",
                "Every breath you take fills you with strength.",
                "You are a master of your own destiny.",
                "Your intuition guides you to the right path.",
                "You are creating a life you love.",
                "Gratitude fills your heart and soul.",
                "You are capable of achieving anything you set your mind to.",
                "Your kindness makes a difference in the world.",
                "You are resilient and can overcome any obstacle.",
                "You are deserving of happiness and success.",
                "You embrace change with an open heart.",
                "Your inner strength is boundless.",
                "You are a source of inspiration to others.",
                "You are surrounded by positive energy.",
                "You radiate confidence and self-love.",
                "You are exactly where you need to be.",
                "Your dreams are within reach.",
                "You are a powerful creator of your reality.",
                "You are a beautiful soul, inside and out.",
                "You are constantly evolving and improving.",
                "You find joy in the simple moments.",
                "You are a force for good in the world.",
                "You are a true blessing to those around you.",
                "I am open to receiving all the good life has to offer.",
                "My life is a reflection of my positive thoughts.",
                "I am living my purpose with joy and passion.",
                "Every day is an opportunity to learn and grow.",
                "I am filled with infinite potential.",
                "I choose to see the good in every situation.",
                "My spirit is free and my heart is open.",
                "I am aligned with the flow of the universe.",
                "I release anything that no longer serves me.",
                "I am a magnet for positive experiences.",
                "I trust the journey and embrace the unknown.",
                "I am creating a life beyond my wildest dreams.",
                "I am a powerful force for good in the world.",
                "My life is a testament to my positive mindset.",
                "I am always guided towards my highest good.",
                "I attract opportunities that align with my purpose.",
                "I am filled with endless possibilities.",
                "I am a channel for divine inspiration.",
                "Every challenge is a stepping stone to greatness.",
                "I am grateful for the journey and the destination.",
                "I am surrounded by positive influences.",
                "I am a magnet for joy, peace, and abundance."
            ],
            "Confidence & Self-Worth": [
                "I am confident and believe in myself.",
                "My self-worth is inherent and unconditional.",
                "I am capable of achieving anything I set my mind to.",
                "I trust my abilities and my decisions.",
                "I am proud of who I am and who I am becoming.",
                "My confidence grows stronger every day.",
                "I am worthy of respect and love.",
                "I embrace my strengths and my unique qualities.",
                "I am fearless in the pursuit of what sets my soul on fire.",
                "I speak my truth with courage and conviction.",
                "I am a powerful and valuable individual.",
                "I am enough, exactly as I am.",
                "I radiate self-assurance and inner peace.",
                "My voice is important and deserves to be heard.",
                "I step into my power with grace and ease.",
                "I am bold and brave in all my endeavors.",
                "I trust my instincts implicitly.",
                "I am a unique and irreplaceable being.",
                "My inner critic is silenced by my unwavering self-belief.",
                "I stand tall in my authenticity.",
                "I am confident in my own skin.",
                "I am resilient and bounce back from setbacks.",
                "I am my own biggest supporter.",
                "I am worthy of success and happiness."
            ],
            "Calm & Peace": [
                "I am calm and at peace with myself and the world.",
                "My mind is clear and serene.",
                "I release all tension and stress from my body.",
                "I breathe in peace and breathe out worry.",
                "I am centered and grounded in the present moment.",
                "Peace flows through me and around me.",
                "I choose tranquility and inner harmony.",
                "I am safe and secure.",
                "Every cell in my body is relaxed and at ease.",
                "I find stillness in the midst of chaos.",
                "I am a haven of peace.",
                "I allow peace to guide my actions.",
                "I release the need to control and embrace the flow.",
                "My breath is my anchor to peace.",
                "I am surrounded by a bubble of calm.",
                "I let go of what I cannot change.",
                "My inner world is a sanctuary of peace.",
                "I am in harmony with the rhythm of life.",
                "I choose to respond with peace, not react with fear.",
                "I am present and mindful in every moment.",
                "My thoughts are calm, and my spirit is light.",
                "I find peace in every breath.",
                "I am truly at peace.",
                "My life is a reflection of my inner calm.",
                "I am a tranquil oasis in a busy world.",
                "I release all anxiety and embrace serenity.",
                "My mind is a peaceful garden.",
                "I am balanced and grounded.",
                "I choose to respond with love and understanding.",
                "I am free from worry and doubt.",
                "My inner peace is unshakeable.",
                "I create a peaceful environment for myself.",
                "I am a vessel of calm.",
                "I welcome peace into every aspect of my life."
            ],
            "Motivation & Success": [
                "I am motivated to achieve my goals.",
                "Success flows to me effortlessly.",
                "I am focused and determined.",
                "Every step I take leads me closer to my dreams.",
                "I embrace challenges as opportunities for growth.",
                "I am a powerful creator of my own success.",
                "My actions are aligned with my highest vision.",
                "I am persistent and never give up.",
                "I am open to new possibilities and opportunities.",
                "I celebrate every small victory.",
                "I am unstoppable.",
                "I am building the life of my dreams.",
                "I am driven by purpose and passion.",
                "My efforts are always rewarded.",
                "I attract success in all my endeavors.",
                "I am a magnet for opportunities.",
                "I overcome obstacles with ease and grace.",
                "My potential for success is infinite.",
                "I am a visionary and an achiever.",
                "I am constantly moving forward.",
                "I am dedicated to my growth and success.",
                "I am a winner in all aspects of my life.",
                "I am achieving my goals with ease.",
                "My future is bright and successful.",
                "I am inspired and inspiring.",
                "I take consistent action towards my desires.",
                "My determination fuels my accomplishments.",
                "I am a force of positive change.",
                "I embrace the journey of success.",
                "I am resourceful and find solutions.",
                "My hard work pays off abundantly.",
                "I am a master of my own destiny.",
                "I am committed to my highest potential.",
                "I am always moving forward with purpose."
            ],
            "Gratitude & Abundance": [
                "I am grateful for all the blessings in my life.",
                "Abundance flows to me in many forms.",
                "I appreciate the simple joys every day.",
                "My heart is filled with gratitude.",
                "I attract prosperity and wealth.",
                "I am thankful for every experience, good or challenging.",
                "The universe provides for all my needs.",
                "I am rich in love, health, and happiness.",
                "I see abundance everywhere I look.",
                "My life is full of blessings.",
                "I am grateful for this moment.",
                "Thank you, thank you, thank you.",
                "I am a magnet for miracles and blessings.",
                "Every day I discover new reasons to be grateful.",
                "My life is overflowing with good.",
                "I am grateful for my health and vitality.",
                "I appreciate the beauty around me.",
                "I am thankful for the love in my life.",
                "I attract financial abundance easily.",
                "My gratitude opens doors to more blessings.",
                "I live in a state of constant appreciation.",
                "I am grateful for every opportunity.",
                "Abundance is my natural state.",
                "I am thankful for my journey.",
                "I am open to receiving unlimited abundance.",
                "My heart is full of thanks for all that is.",
                "I am a channel for divine prosperity.",
                "I attract wealth and success effortlessly.",
                "Every day brings new reasons to be grateful.",
                "I am blessed with more than enough.",
                "I appreciate the richness of my life.",
                "My gratitude multiplies my blessings.",
                "I am living a life of overflowing abundance.",
                "I am grateful for the gift of life."
            ],
            "Love & Relationships": [
                "I am surrounded by love and loving relationships.",
                "I give and receive love freely.",
                "My heart is open to deep connections.",
                "I attract healthy and supportive relationships.",
                "I am worthy of true love.",
                "I nurture my relationships with care and kindness.",
                "Love is my guiding force.",
                "I forgive myself and others easily.",
                "I am a loving and compassionate being.",
                "My relationships are filled with joy and harmony.",
                "I am connected to all beings through love.",
                "Love starts with me.",
                "I am a magnet for healthy and fulfilling relationships.",
                "My relationships are filled with mutual respect.",
                "I communicate with love and understanding.",
                "I am surrounded by people who uplift me.",
                "I cherish the connections in my life.",
                "I attract genuine and heartfelt connections.",
                "My love is a powerful force for good.",
                "I am open to new friendships and deeper bonds.",
                "I am a source of love and light.",
                "I am loved unconditionally.",
                "My relationships are strong and supportive.",
                "I attract true companionship.",
                "I cultivate loving and positive connections.",
                "My heart is open to giving and receiving love.",
                "I am a compassionate and understanding friend.",
                "I attract souls who resonate with my highest self.",
                "Every interaction is an opportunity for love.",
                "I am surrounded by a network of love and support.",
                "I am a magnet for healthy and joyful partnerships.",
                "My relationships are built on trust and respect.",
                "I express my love freely and authentically.",
                "I am loved, cherished, and adored."
            ],
            "Health & Well-being": [
                "My body is healthy, strong, and vibrant.",
                "I nourish my body with wholesome foods and positive thoughts.",
                "I am filled with energy and vitality.",
                "I prioritize my well-being every day.",
                "My mind and body are in perfect harmony.",
                "I make choices that support my health.",
                "I am healing and becoming stronger.",
                "I listen to my body's wisdom.",
                "I am committed to my health journey.",
                "I feel amazing and full of life.",
                "My immune system is strong and resilient.",
                "I am a picture of perfect health.",
                "I am filled with boundless energy.",
                "My body is a temple, and I treat it with respect.",
                "I am dedicated to my physical and mental well-being.",
                "I choose healthy habits that empower me.",
                "I am strong, active, and full of life.",
                "My mind is calm, and my body is relaxed.",
                "I am grateful for my healthy body.",
                "I am in tune with my body's needs.",
                "I am vibrant and full of life.",
                "I am healing and regenerating.",
                "My health is my wealth.",
                "I am well and whole.",
                "I am a master of my own well-being.",
                "Every day I feel healthier and more alive.",
                "I listen to my body's signals with care.",
                "I am filled with positive energy and vitality.",
                "My body is a source of strength and comfort.",
                "I embrace a lifestyle of health and happiness.",
                "I am in control of my health choices.",
                "I am grateful for my incredible body.",
                "I am thriving in mind, body, and spirit.",
                "I am perfectly healthy and whole."
            ],
            "Creativity & Growth": [
                "My creativity flows effortlessly and abundantly.",
                "I am constantly learning and growing.",
                "I embrace new ideas and perspectives.",
                "I am open to inspiration from all sources.",
                "My mind is fertile ground for innovative ideas.",
                "I express myself authentically and creatively.",
                "Every day is an opportunity for new discoveries.",
                "I am always evolving into my highest self.",
                "I am a lifelong learner.",
                "My imagination knows no bounds.",
                "I find joy in the process of creation.",
                "I am expanding my consciousness.",
                "I am a powerful creator.",
                "My ideas are valuable and unique.",
                "I am inspired by the world around me.",
                "I fearlessly explore new paths.",
                "I am a master of my craft.",
                "I am constantly improving and refining my skills.",
                "My creativity is a gift to the world.",
                "I am open to new ways of thinking and being.",
                "I am a visionary.",
                "I am growing beyond my limits.",
                "I am always expanding my knowledge.",
                "My potential for growth is infinite.",
                "I am a wellspring of innovative solutions.",
                "I embrace challenges as opportunities to learn.",
                "My mind is sharp and agile.",
                "I am a catalyst for positive change.",
                "I am always discovering new talents within myself.",
                "I am committed to continuous improvement.",
                "My creativity knows no limits.",
                "I am a pioneer of new ideas.",
                "I am constantly evolving and expanding.",
                "I am growing into my full potential."
            ]
        };

        // Get references to HTML elements
        const userNameInput = document.getElementById('userName');
        const categorySelect = document.getElementById('categorySelect');
        const voiceSelect = document.getElementById('voiceSelect');
        const generateBtn = document.getElementById('generateBtn');
        const affirmationOutput = document.getElementById('affirmationOutput');
        const copyBtn = document.getElementById('copyBtn');
        const listenBtn = document.getElementById('listenBtn');
        const shareWhatsappBtn = document.getElementById('shareWhatsappBtn');
        const shareTwitterBtn = document.getElementById('shareTwitterBtn');

        // Initialize SpeechSynthesisUtterance for audio
        const synth = window.speechSynthesis;
        let utterance = new SpeechSynthesisUtterance();

        /**
         * Populates the category dropdown with options from affirmationsByCategory.
         */
        function populateCategories() {
            categorySelect.innerHTML = ''; // Clear existing options

            const allOption = document.createElement('option');
            allOption.value = "All Categories";
            allOption.textContent = "All Categories (Random)";
            categorySelect.appendChild(allOption);

            Object.keys(affirmationsByCategory).forEach(category => {
                if (category !== "All Categories") {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                }
            });
        }

        /**
         * Populates the voice dropdown with available voices.
         * Sets a default voice if preferred.
         */
        function populateVoiceList() {
            voiceSelect.innerHTML = ''; // Clear existing options
            const voices = synth.getVoices();

            const autoOption = document.createElement('option');
            autoOption.value = ""; // Empty string means browser default
            autoOption.textContent = "Auto (Browser Default)";
            voiceSelect.appendChild(autoOption);

            let defaultVoiceFound = false;

            voices.forEach(voice => {
                const option = document.createElement('option');
                option.value = voice.name;
                option.textContent = `${voice.name} (${voice.lang})`;

                // Attempt to select a common English US voice by default
                if (voice.lang === 'en-US' && (voice.name.includes('Google') || voice.name.includes('Microsoft')) && !defaultVoiceFound) {
                    option.selected = true;
                    defaultVoiceFound = true;
                }
                voiceSelect.appendChild(option);
            });

            // If no preferred voice was found and selected, ensure "Auto" is selected
            if (!defaultVoiceFound && voiceSelect.value === "") {
                 voiceSelect.selectedIndex = 0;
            }
        }

        // Crucial: Ensure voices are loaded before populating the list
        // onvoiceschanged fires when voices are loaded or changed
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = populateVoiceList;
        }
        // Also try to populate immediately, in case voices are already loaded
        populateVoiceList();


        /**
         * Generates a random affirmation based on the selected category.
         * Personalizes it with the user's name if provided.
         */
        function generateAffirmation() {
            const name = userNameInput.value.trim();
            const selectedCategory = categorySelect.value;
            let affirmationsToUse = [];

            if (selectedCategory === "All Categories") {
                for (const category in affirmationsByCategory) {
                    affirmationsToUse = affirmationsToUse.concat(affirmationsByCategory[category]);
                }
            } else {
                affirmationsToUse = affirmationsByCategory[selectedCategory];
            }

            if (affirmationsToUse.length === 0) {
                affirmationOutput.textContent = "No affirmations found for this category. Please try another!";
                affirmationOutput.classList.add('show');
                return;
            }

            const randomIndex = Math.floor(Math.random() * affirmationsToUse.length);
            let selectedAffirmation = affirmationsToUse[randomIndex];

            if (name) {
                selectedAffirmation = `${name}, ${selectedAffirmation}`;
            }

            if (synth.speaking) {
                synth.cancel(); // Stop any ongoing speech
            }

            affirmationOutput.classList.remove('show');
            setTimeout(() => {
                affirmationOutput.textContent = selectedAffirmation;
                affirmationOutput.classList.add('show');
            }, 100);
        }

        /**
         * Copies the current affirmation text to the clipboard.
         */
        function copyAffirmation() {
            const textToCopy = affirmationOutput.textContent;
            if (!textToCopy || textToCopy === "Your affirmation will appear here!") {
                console.log("No affirmation to copy.");
                return;
            }

            // Use document.execCommand('copy') for broader compatibility in iframes
            const tempInput = document.createElement('textarea');
            tempInput.value = textToCopy;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);

            const originalText = copyBtn.textContent;
            copyBtn.textContent = "✅ Copied!";
            setTimeout(() => {
                copyBtn.textContent = originalText;
            }, 1500);
        }

        /**
         * Reads the current affirmation aloud using the Web Speech API.
         */
        function listenAffirmation() {
            const textToSpeak = affirmationOutput.textContent;
            if (!textToSpeak || textToSpeak === "Your affirmation will appear here!") {
                console.log("No affirmation to speak.");
                return;
            }

            if (synth.speaking) {
                synth.cancel();
            }

            utterance.text = textToSpeak;
            utterance.rate = 1;
            utterance.pitch = 1;

            // Set the selected voice
            const selectedVoiceName = voiceSelect.value;
            if (selectedVoiceName) {
                const voices = synth.getVoices();
                const selectedVoice = voices.find(voice => voice.name === selectedVoiceName);
                if (selectedVoice) {
                    utterance.voice = selectedVoice;
                    utterance.lang = selectedVoice.lang; // Use the voice's natural language
                }
            } else {
                utterance.voice = null; // Use browser default if "Auto" is selected
                utterance.lang = 'en-US'; // Fallback language
            }

            synth.speak(utterance);
        }

        /**
         * Shares the current affirmation via WhatsApp.
         */
        function shareToWhatsapp() {
            const affirmationText = affirmationOutput.textContent;
            if (!affirmationText || affirmationText === "Your affirmation will appear here!") return;

            const shareText = `Today's affirmation gave me life! 🌞 Check this out: "${affirmationText}" - Get yours at ${window.location.href}`;
            const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(shareText)}`;
            window.open(whatsappUrl, '_blank');
        }

        /**
         * Shares the current affirmation via X (Twitter).
         */
        function shareToTwitter() {
            const affirmationText = affirmationOutput.textContent;
            if (!affirmationText || affirmationText === "Your affirmation will appear here!") return;

            const shareText = `Today's affirmation gave me life! 🌞 Check this out: "${affirmationText}"`;
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(window.location.href)}`;
            window.open(twitterUrl, '_blank');
        }


        // --- Event Listeners ---

        // Ensure all DOM elements are loaded before running initial setup
        window.onload = () => {
            populateCategories();
            // populateVoiceList is handled by onvoiceschanged or immediate call
            generateAffirmation(); // Generate an initial affirmation on load
        };

        generateBtn.addEventListener('click', generateAffirmation);
        userNameInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                generateAffirmation();
            }
        });
        categorySelect.addEventListener('change', generateAffirmation);
        voiceSelect.addEventListener('change', () => {
            if (synth.speaking) {
                synth.cancel(); // Stop current speech if voice changes
            }
            // Optionally, you could call listenAffirmation() here to immediately hear the current affirmation with the new voice
        });

        copyBtn.addEventListener('click', copyAffirmation);
        listenBtn.addEventListener('click', listenAffirmation);
        shareWhatsappBtn.addEventListener('click', shareToWhatsapp);
        shareTwitterBtn.addEventListener('click', shareTwitter);

    </script>
</body>
</html>

